# PE-BCKDR

## Only for x86 (at the moment)

## Features
  - Analyse a PE file: sections, entry point, ASLR, first few assembly instructions, etc.
  - Find code caves


## Example

### Analyse a PE file
```
  ./pe-bckdr-x86.py -f <YOUR PE> --analyse

  [*] Loading PE file ("samples/putty.exe")

  [*] Analysis
   - Entry point: 0x97fd6
   - ASLR is enabled
   - PE 32-bit!
   - PE sections - 10 section(s)
          VOffset        VSize        Size        Name        Flags
          ------------------------------------------------------------
          0x1000        0x4           0x200         .00cfg        r--  
          0x2000        0x24720       0x24800       .rdata        r--  
          0x27000       0x3aa4        0x0           .bss          rw-  
          0x2b000       0xb90         0xc00         .data         rw-  
          0x2c000       0xb4          0x200         .gfids        r--  
          0x2d000       0x2eb0        0x3000        .rsrc         rw-  
          0x30000       0x87ba6       0x87c00       .text         r-x  
          0xb8000       0x60c         0x800         .xdata        r--  
          0xb9000       0x20d0        0x2200        .idata        r--  
          0xbc000       0x6db4        0x6e00        .reloc        r--  

   - ASM instructions @entry point
         0:   e8 8a 02 00 00          call   0x28f
         5:   e9 8e fe ff ff          jmp    0xfffffe98
         a:   55                      push   ebp
         b:   8b ec                   mov    ebp,esp
         d:   a1 38 b2 42 00          mov    eax,ds:0x42b238
        12:   83 e0 1f                and    eax,0x1f
        15:   6a 20                   push   0x20
        17:   59                      pop    ecx
        18:   2b c8                   sub    ecx,eax
        1a:   8b 45 08                mov    eax,DWORD PTR [ebp+0x8]
        1d:   d3                      .byte 0xd3

  [*] Finished.
  Exiting...
```

### Find code caves
```
  ./pe-bckdr-x86.py -f samples/putty.exe --fcc    

  [*] Loading PE file ("samples/putty.exe")

  [*] Analysis
   - Entry point: 0x97fd6
   - ASLR is enabled
   - PE 32-bit!

  [*] Looking for code caves
      - Section: .00cfg - @0x1000
      - Section: .rdata - @0x2000
       [0] -> Found a code cave: 343 bytes, starting @0x2771
       [1] -> Found a code cave: 260 bytes, starting @0x233b4
       [2] -> Found a code cave: 257 bytes, starting @0x235b7
      - Section: .bss - @0x27000
      - Section: .data - @0x2b000
       [3] -> Found a code cave: 205 bytes, starting @0x2b4cc
       [4] -> Found a code cave: 223 bytes, starting @0x2b5d3
       [5] -> Found a code cave: 198 bytes, starting @0x2b6ec
       [6] -> Found a code cave: 140 bytes, starting @0x2b7ec
       [7] -> Found a code cave: 196 bytes, starting @0x2b9bc
      - Section: .gfids - @0x2c000
      - Section: .rsrc - @0x2d000
      - Section: .text - @0x30000
      - Section: .xdata - @0xb8000
      - Section: .idata - @0xb9000
      - Section: .reloc - @0xbc000

  [*] Finished.
  Exiting...
```
