#!/usr/bin/python
import pefile


FILE = "calc.exe"

# Load PE file
def load_pe_file(filename):
    print "\n[*] Loading PE file => \"%s\"" % (filename)
    return pefile.PE(filename)

def iterate_trough_pe_sections(pe_struct):
    print "\n[*] PE sections"
    print " Name\t\tVOffset\t\tVSize\t\tSize"
    for section in pe_struct.sections:
        print "  %s\t\t%s\t\t%s\t\t%s" % (section.Name, hex(section.VirtualAddress), hex(section.Misc_VirtualSize), hex(section.SizeOfRawData))

pe_struct = load_pe_file(FILE)
iterate_trough_pe_sections(pe_struct)


print hex(pe_struct.OPTIONAL_HEADER.AddressOfEntryPoint)
