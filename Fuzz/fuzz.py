#!/usr/bin/python
import socket
import sys
import time

IP = "XXX.XXX.XXX.XXX"
PORT = 00
TIMEOUT = 5

def send_closed_tcp(MESSAGE):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(TIMEOUT)
        s.connect((IP, PORT))
        s.send(MESSAGE)
        data = s.recv(1024)
        s.close()
        return 1
    except socket.error, exc:
        print "[!] Can't connect to %s:%d - with MSG length %d - might be due to crash" % (IP, PORT, len(MESSAGE))
        return 0

def send_closed_udp(MESSAGE):
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        s.sendto(MESSAGE, (IP, PORT))
        s.close()
        return 1
    except socket.error, ecx:
        print "[!] Can't connect to %s:%d - with MSG length %d - might be due to crash" % (IP, PORT, len(MESSAGE))
        return 0

def c_print(MESSAGE):
    print MESSAGE

def start_fuzzing(funct, PRE="", POST="", MAX = 5000):
    print "[*] Start fuzzing, with MAX: %d" % (MAX)
    time.sleep(2)
    for i in range(0, MAX):
        if not funct(PRE + "A" * i + POST):
            break

print "[*] Starting Fuzzer\n"

# Scenario
MSG = ""
send_closed_udp(MSG)
