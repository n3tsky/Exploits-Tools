#!/usr/bin/python
import sys
from binascii import unhexlify

# Get through all hex characters, except for forbidden ones
def getBadChars(forbidden):
    result = ""
    print "[*] List of all forbidden characters: %s" % (forbidden.split("x"))
    for i in xrange(0x00, 0xFF + 1):
        if "{:02x}".format(i) not in forbidden.split("x"):
            result += "$%.2x" % i
    return result.replace('$',r'\x')

if __name__ == "__main__":

    if len(sys.argv) > 2 or len(sys.argv) < 1:
        print "[*] Usage: %s <optional: \\x??\\x??>" % (sys.argv[0])
        sys.exit(-1)

    forbidden = ""
    if len(sys.argv) == 2:
        forbidden = sys.argv[1]

    result = getBadChars(forbidden)
    print "[*] Length: %d\n" % (len(result))

    print "badchars = \"\""
    for i in range(0, len(result), 32):
        print "badchars += \"%s\"" % (result[i:i+32])
