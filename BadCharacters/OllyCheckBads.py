#!/usr/bin/python
import sys

def open_file(file):
    with open(file,"r") as fin:
        result = fin.read().splitlines()
        result = ''.join(result)
        result = result.replace("\\x","")
        result = result.replace(" ","")
        result = result.lower()
        return result

def check(str1, str2):
    if len(str1) != len(str2):
        print "[!] Shellcode and Olly output are not equals"
        print "[!] Length str1: %d" % (len(str1))
        print "[!] Length str2: %d" % (len(str2))
    else:
        print "[*] Both shellcode are equals"

    error = 0
    for e in range(0, len(str1), 2):
        p_str1 = str1[e:e+2]
        p_str2 = str2[e:e+2]
        if p_str2 != p_str1:
            print "[!] Error @index: %d, shellcode: 0x%s != olly: 0x%s" % (e, p_str1, p_str2)
            error += 1

    if not error:
        print "[*] Both shellcode are equals"

if (len(sys.argv) != 3):
    print "Usage: %s <shellcode file> <olly 'binary copy' output>" % (sys.argv[0])
    sys.exit(1)

print ""
shellcode_file_content = open_file(sys.argv[1])
olly_file_content = open_file(sys.argv[2])
check(shellcode_file_content, olly_file_content)
