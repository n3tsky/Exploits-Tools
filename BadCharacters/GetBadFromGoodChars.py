#!/usr/bin/python
import sys
from binascii import unhexlify

# Get through all hex characters, except for forbidden ones
def getBadFromGoodChars(good):
    result = ""
    print "[*] List of all good characters: %s" % (good.split("x"))
    for i in xrange(0x00, 0xFF + 1):
        if "{:02x}".format(i) not in good.split("x"):
            result += "$%.2x" % i

    print result.replace('$',r'\x')
    return result.replace('$',r'\x')

if __name__ == "__main__":

    if len(sys.argv) > 2 or len(sys.argv) < 1:
        print "[*] Usage: %s <optional good chars: \\x??\\x??>" % (sys.argv[0])
        sys.exit(-1)

    good = ""
    if len(sys.argv) == 2:
        good = sys.argv[1]

    result = getBadFromGoodChars(good)
    print "[*] Length: %d\n" % (len(result))

    print "badchars = \"\""
    for i in range(0, len(result), 32):
        print "badchars += \"%s\"" % (result[i:i+32])
